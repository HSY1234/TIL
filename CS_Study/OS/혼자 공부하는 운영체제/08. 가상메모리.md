# 가상 메모리 (virtual memory)

- 실행하고자 하는 프로그램을 일부만 메모리에 적재하여 실제 메모리 크기보다 더 큰 프로세스를 실행 할수 있게 하는 기술
- 페이징 (paging)
- 세그멘테이션 (Segmentation)

# 가상메모리 등장이전

## 연속 메모리 할당

- 지금까지 메모리내에 프로세스들이 연속적으로 배치되는 상황을 가정
- 메모리에 프로세스 다음에 프로세스를 연속적으로 할당하는 방식을 **연속 메모리 할당**이라 함

## 스와핑

- 프로세스중 실행되지 않는 프로세스를 임시로 **보조기억장치 일부 영역**으로 쫓아내고, 빈공간에 새로운 프로세스를 적재하여 실행하는 방식을 **스와핑**(swapping)이라고 한다
  - 입출력 작업 요구로 대기 상태인 프로세스
  - 오랫동안 사용되지 않은 프로세스
- 스왑 영역(swap space) : 프로세스들이 쫓겨나는 보조기억장치의 일부 영역
- 스왑 아웃(swap out) : 보조기억장치들이 메모리에서 보조기억장치로 나가는것
- 스왑 인(swap in) : 보조기억장치에 저장한 프로세스를 다시 메모리로 가져오는것
- 스왑 아웃되었던 프로세스가 다시 스왑 인될때 물리주소는 다른곳이 될수 있다
- 스와핑을 이용하면 프로세스들이 요구하는 메모리 주소 공간의 크기가 실제 메모리 크기보다 큰 경우도 프로세스들을 동시 실행가능

## 메모리 할당 방식

- 최초 적합
- 최적 적합
- 최악 적합

## 최초 적합 (first fit)

- 운영체제가 메모리 내의 빈 공간을 순서대로 검색하다가 적재할 수 있는 공간을 발견하면 그 공간에 프로세스를 배치
- 검색을 최소화 = 빠른 할당 가능

## 최적 적합 (best fit)

- 운영체제가 빈 공간을 모두 검색후, 적재될수 있는 공간중 가장 작은 공간에 프로세스 적재

## 최악 적합 (worst fit)

- 운영체제가 빈 공간을 모두 검색후, 적재될수 있는 공간중 가장 큰 공간에 프로세ㅡ 적재

## 외부 단편화 (external fragmentation)

- 연속적으로 할당되는 환경에서는, 프로세스들이 실행되고 종료되기를 반복하면서 메모리 사이의 빈 공간이 생길수 밖에 없다.
- 빈 공간들이 점점 자잘한 사이즈로 생기면서, 결과적으로 큰 프로세스는 적재하기 힘들어지고 이는 메모리 낭비로 이어진다
- 이러한 현상을 **외부 단편화** 라고 한다

## 압축(compaction)

- 외부 단편화를 해결하기위한 한가지 방법, 메모리 조각 모음이라고도 부름
- 흩어져있는 빈 공간들을 하나로 모으는 방식
- 프로세스의 물리적 주소를 재배치한다
- 하나로 모으는 동안 모든 프로세스들은 하던 중지되어야하고, 메모리에 있는 내용을 옮기는 작업은 큰 오버헤드를 야기하며, 어떤 프로세스를 어떻게 옮겨야 오버헤드가 최소화되고 압축할수있는지 방법을 정하는일은 어려움
- 한계를 해결하기 위해 페이징 등장
