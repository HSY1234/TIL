# 데이터 링크 계층

- **네트워크 장비 간에 신호를 주고받는 규칙**을 정하는 계층
- 랜에서 데이터를 주고 받으려면 데이터 링크 계층의 기술이 필요
- 일반적으로 가장 많이 사용되는 규칙 **이더넷**(Ethernet)

# 이더넷

- 이더넷은 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고 받을 때 사용
- 허브는 모든 연결된 컴퓨터로 데이터를 보내는데, 보낼때 데이터에 **목적지**를 추가해서 보내면 목적지 이외의 컴퓨터는 데이터를 받아도 무시한다
- 확실히 무시하도록 규칙으로 정해져있어서 몰래 볼수 없다
- 이더넷은 **여러 컴퓨터가 동시에 데이터를 전송**해도 충돌이 일어나지 않는 구조로 되어 있다
  - **충돌**은 데이터가 동시에 전송될때 서로 부딪히는 현상
- 한 케이블에 동시에 데이터가 지나가면 충돌이 발생하므로, 이더넷은 데이터 보내는 시점을 늦춘다
- 이를 **CSMA/CD**(Carrier Sense Multiple Access with Collision Detection)라고 한다
- CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지 확인하는 규칙
- MA: 케이블에 데이터가 흐르지 않는다면 데이터를 보내도 좋다
- CD: 충돌이 발생하고 있는지 확인한다
- CSMA/CD는 효율이 좋지 않기 때문에 최근에는 **스위치** 장비에서 충돌을 막음

# MAC 주소

- NIC(이하 랜카드)는 비트열(0과 1) <-> 전기신호 변환하는 장치
- 랜카드마다 고유한 **MAC 주소**(Media Access Control Address)를 가짐
- MAC주소는 제조할때 제조사가 새기는 **물리 주소**, **전 세계의 유일한 번호로 할당**
- 48비트로 구성, 앞의 24비트는 제조사 번호, 뒤의 24비트는 제조사가 랜 카드에 붙인 일련번호
- OSI의 데이터 링크 계층 = TCP/IP의 네트워크 계층에서 **이더넷 헤더**와 **트레일러**를 붙임
- 이더넷 헤더 14바이트
  - 목적지 MAC 주소(6바이트)
  - 출발지 MAC 주소(6바이트)
  - 유형(2바이트) : 이더넷으로 전송되는 상위 계층 프로토콜의 종류 식별 번호(16진수)
    - 0800 : IPv4
    - 0806 : ARP
    - 8035 : RARP
    - 814C : SNMP over Ethernet
    - 86DD : IPv6
- 트레일러
  - **FCS**(Frame Check Sequence) : 데이터 전송 도중에 오류가 발생하는지 확인하는 용도
- 이더넷 헤더와 트레일러가 추가된 데이터를 **프레임**이라고 한다
- 데이터 링크 계층에서 이더넷 헤더와 트레일러를 추가하여 **프레임**을 만들고, 물리 계층에서 프레임 비트열을 **전기 신호**로 변환하여 네트워크에 전송
- 각 컴퓨터는 이더넷 헤더의 목적지 MAC가 자신의 MAC주소와 다르면 데이터를 파기한다
- 두 컴퓨터가 동시에 데이터를 전송 할 경우 CSMA/CD로 한 컴퓨터가 대기하다가 데이터를 다시 전송

# 스위치(switch)

- 스위치는 데이터 링크 계층에서 동작하고 **레이어2 스위치** 또는 **스위칭 허브**라고도 불린다
- 스위치 내부에는 **MAC 주소 테이블**(MAC address talbe)이 존재한다.(브리지 테이블, bridge table)이라고도 함
- MAC 주소 테이블은 스위치의 **포트 번호**와 해당 포트에 연결되어 있는 컴퓨터의 **MAC 주소**가 등록되어 있는 데이터 베이스
